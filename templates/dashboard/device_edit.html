{% extends 'dashboard/base.html' %}

{% block content %}
  <section class="page-header">
    <div>
      <h2>대상자 정보 수정</h2>
      <p>등록된 사용자 정보와 시리얼 번호를 수정합니다.</p>
    </div>
  </section>

  <div class="grid two">
    <section class="card">
      <div class="card-header">
        <h3>수정 폼</h3>
        <span class="chip">Owner + Device</span>
      </div>

      {% if error %}
        <div class="chip danger">{{ error }}</div>
      {% endif %}

      {% if success %}
        <div class="chip safe">{{ success }}</div>
      {% endif %}

      <form method="post" class="quest-form">
        {% csrf_token %}
        <label>
          이름
          <input type="text" name="name" value="{{ device.owner.name }}" required>
        </label>
        <label>
          나이
          <input type="number" name="age" min="0" value="{{ device.owner.age|default:'' }}" placeholder="예: 82">
        </label>
        <label>
          병명/특이사항
          <input type="text" name="conditions" value="{{ device.owner.conditions|default:'' }}" placeholder="예: 관절염, 치매">
        </label>
        <label>
          주소
          <input type="text" name="address" value="{{ device.elderly.address|default:'' }}" placeholder="예: 전주시 덕진동 402-1">
        </label>
        <label>
          비상 연락처
          <input type="text" name="emergency_contact" value="{{ device.elderly.emergency_contact|default:'' }}" placeholder="예: 보호자 010-1234-5678">
        </label>
        <label>
          장치 시리얼 번호
          <input type="text" name="serial" value="{{ device.serial }}" required>
        </label>
        <button type="submit" class="primary">저장하기</button>
      </form>
    </section>

    <section class="card">
      <div class="card-header">
        <h3>현재 연결 정보</h3>
        <span class="chip">Info</span>
      </div>
      <p>개인 번호: <strong>{{ device.owner.user_id }}</strong></p>
      <p>대상자 ID: <strong>{{ device.elderly_id|default:"-" }}</strong></p>
      <p>등록 상태: <strong>{% if device.is_active %}활성{% else %}비활성{% endif %}</strong></p>
    </section>
  </div>
{% endblock %}
